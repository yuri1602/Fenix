# -*- coding: utf-8 -*-
import sqlite3
import sys

# Set UTF-8 encoding for output
sys.stdout.reconfigure(encoding='utf-8')

# Актуален списък от потребителя
valid_materials = {
    "Маркер за дъска Черен",
    "Маркер за дъска Червен",
    "Маркер за дъска Син",
    "Маркер за дъска Зелен",
    "Цветни комплектни маркери за Дъска",
    "Сухо лепило",
    "Гланцови блокчета",
    "Син химикал",
    "Черен химикал",
    "Червен химикал",
    "Подварзия Голяма",
    "Подварзия малка",
    "Течно лепило",
    "Картон за табло",
    "Цветни моливи Комплект",
    "Флумастри Комплект",
    "Тиксо",
    "Хайлайтър Комплекти",
    "Блокче за рисуване А4",
    "Ножица",
    "Линия",
    "Транспортир",
    "Цветна хартия (Пакет)",
    "Плейдо Пластелин",
    "Дъска за Пластелин",
    "Пакт Мокри кърпи",
    "Острилки",
    "Папки за джобове",
    "Пакет джобове (Пакети)",
    "Коректор на лента",
    "Течен коректор",
    "Папки със цип",
    "Гумички",
    "Рафтчета за учебници",
    "Моливници",
    "1 ел.устрилка",
    "Човали за смет 50л.",
    "Човали за смет 20л.",
    "Човали за смет 35л.",
    "Човали за смет 70л.",
    "Кламери (Кутийка)",
    "Телбот (Кутийки)",
    "Лепящи листчета за отбелязване",
    "Гъби за дъска",
    "Папки класьор",
    "Несесер",
    "Розови Химикали",
    "Лилави Химикали",
    "Зелени Химикали",
    "Оранжеви Химикали",
    "Органайзер за бюро",
    "Темперни бои Комплект от 6бр",
    "Темперни бои Комплект от 12бр",
    "Перфоратори",
    "Тънкописец Син",
    "Тънкописец Черен",
    "Тънкописец Розов",
    "Тънкописец червени",
    "Габърчета Кутия",
    "Пермаменти маркери",
    "Телбот Устройство",
    "Водни Бои",
    "Етикети",
    "Четки за боя пакет",
    "Гумички за молив",
    "Графитни Моливи",
    "Чашки за боя",
    "Пиро моливи",
    "Глина",
    "Пастели комплект",
    "Папки с копче",
    "Торбички 10л",
    "Хартия за Принтер(Пакети)",
    "Гъби за миене на съдове",
    "Тетрадки (Малък формат, малки квадрати)",
    "Тетрадки (Малък формат, големи квадрати)",
    "Тетрадки (Малък формат, тесни и широки редове)",
    "Тетрадки (Малък формат, Речник)",
    "Тетрадки (Голям формат, широки редове)",
    "Тетрадки (Малък формат, широки редове)",
    "Нотна тетрадка",
}

conn = sqlite3.connect('school_inventory.db')
cursor = conn.cursor()

# Вземи всички материали
materials = cursor.execute('SELECT id, name FROM materials ORDER BY name').fetchall()

# Намери кои трябва да се изтрият
to_delete = []
for mat_id, mat_name in materials:
    # Normalize the name (remove extra spaces, etc.)
    normalized_name = ' '.join(mat_name.split())
    
    if normalized_name not in valid_materials:
        to_delete.append((mat_id, mat_name))

print(f"=== ЩЕ БЪДАТ ИЗТРИТИ {len(to_delete)} МАТЕРИАЛА ===\n")
for mat_id, mat_name in to_delete:
    print(f"{mat_id:3d}. {mat_name}")

if to_delete:
    print("\n=== ИЗТРИВАНЕ... ===")
    for mat_id, mat_name in to_delete:
        cursor.execute('DELETE FROM materials WHERE id = ?', (mat_id,))
        print(f"✓ Изтрит: {mat_name}")
    
    conn.commit()
    print(f"\n✅ ГОТОВО! Изтрити са {len(to_delete)} материала.")
else:
    print("\n✅ Няма материали за изтриване.")

conn.close()
